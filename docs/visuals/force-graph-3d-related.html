<head>
    <style> body {
        margin: 0;
    } </style>

    <script src="https://unpkg.com/3d-force-graph"></script>
</head>

<body>
<div id="3d-graph"></div>

<script>
    const gData = {
        "nodes": [],
        "links": []
    }

    // [{"source": "...", "target": "", "count": 1}...]
    gData.links = [{"source": "155-155Architecture", "target": "326-704Architecture/design processes", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "820-878Document all trust boundaries and significant data flows", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "515-021Sandbox, containerize and/or isolate applications at the network level", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "113-133Use centralized authentication mechanism", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "278-413Mutually authenticate application components. Minimize privileges", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "612-252Separate GraphQL (or similar) authorization logic from data layer", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "848-711Enforce input validation on a trusted service layer", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "117-371Use a centralized access control mechanism", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "708-355Secure implemented architecture", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "344-611Use centralized reusable security controls", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "640-364Enforce access control on trusted parts/serverside", "count": 2, "type": "Related"}, {"source": "155-155Architecture", "target": "650-560Enforce access control on trusted service layer", "count": 2, "type": "Related"}, {"source": "486-813Configuration", "target": "124-564Configuration Management", "count": 2, "type": "Related"}, {"source": "486-813Configuration", "target": "154-031Harden application by excluding unwanted functionality", "count": 2, "type": "Related"}, {"source": "486-813Configuration", "target": "462-245Remove unnecessary elements from external components (e.g. features, documentation, configuration)", "count": 2, "type": "Related"}, {"source": "486-813Configuration", "target": "233-748Configuration hardening", "count": 2, "type": "Related"}, {"source": "486-813Configuration", "target": "308-515Prevent security disclosure", "count": 2, "type": "Related"}, {"source": "486-813Configuration", "target": "764-507Restrict XML parsing (against XXE)", "count": 2, "type": "Related"}, {"source": "486-813Configuration", "target": "333-888Do not expose data through API URLs", "count": 2, "type": "Related"}, {"source": "486-813Configuration", "target": "186-540Do not expose data through HTTP verb", "count": 2, "type": "Related"}, {"source": "486-813Configuration", "target": "430-636Verify TLS certificates and trust chain", "count": 2, "type": "Related"}, {"source": "486-813Configuration", "target": "615-744Protect against directory browsing/discovery attacks", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "333-858Resist stolen credentials", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "585-408Challenge nonce cryptography", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "062-850MFA/OTP", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "841-757Use approved cryptographic algorithms in generation, seeding and verification of OTPs", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "206-254Use secure random to generate initial authentication codes", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "543-428Use security module to store one-time password verification keys", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "605-735Authenticate all external connections", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "435-702Communication encryption", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "527-034Protect communication between application components", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "426-842Verify the authenticity of both headers and payload", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "228-551TLS", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "248-646Disable insecure SSL/TLS versions", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "400-007Encrypt data at rest", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "742-432Encryption algorithms", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "223-780Secret storage", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "542-270Secure random values", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "664-571Ensure proper generation of secure random", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "704-530Enforce high entropy session tokens", "count": 2, "type": "Related"}, {"source": "170-772Cryptography", "target": "727-043Ensure secure algorithms for generating session tokens", "count": 2, "type": "Related"}, {"source": "028-727CSRF protection", "target": "464-084Add CSRF protection for cookie based REST services", "count": 2, "type": "Related"}, {"source": "028-727CSRF protection", "target": "342-055Set \"samesite\" attribute for cookie-based session tokens", "count": 2, "type": "Related"}, {"source": "028-727CSRF protection", "target": "060-472Use CSRF protection against authenticated functionality, add anti-automation controls for unauthenticated functionality", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "132-146Apply defense-in-depth techniques/processes for protection, detection, and timely response to network-based attacks.", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "630-573Detect and protect against automation abuse", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "163-518Check uploaded archives for decompression attacks (eg zip bombs)", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "463-820Limit size and number of uploaded files", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "660-052Validate max input/file sizes", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "176-154Monitor expectation of usage intensity (e.g. number of requests)", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "268-088Limit query impact GraphQL/data layer expression DoS", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "854-643Robust business logic", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "725-682Enable configurable alert against usage anomalies", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "456-535Monitor for realistic \"human time\" business logic flows", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "418-853Monitor unusual activities on system", "count": 2, "type": "Related"}, {"source": "623-550Denial Of Service protection", "target": "267-031Protect the availability of resources by providing more to higher-priority processes", "count": 2, "type": "Related"}, {"source": "760-764Injection protection", "target": "760-765XSS protection", "count": 2, "type": "Related"}, {"source": "760-764Injection protection", "target": "384-344Store and serve user-uploaded files such that they cannot execute/damage server or client", "count": 2, "type": "Related"}, {"source": "760-764Injection protection", "target": "010-308Input validation", "count": 2, "type": "Related"}, {"source": "760-764Injection protection", "target": "866-553Memory, String, and Unmanaged Code", "count": 2, "type": "Related"}, {"source": "760-764Injection protection", "target": "161-451Output encoding and injection prevention", "count": 2, "type": "Related"}, {"source": "760-764Injection protection", "target": "764-765Sanitization and sandboxing", "count": 2, "type": "Related"}, {"source": "760-764Injection protection", "target": "541-441Validate HTTP request headers", "count": 2, "type": "Related"}, {"source": "760-764Injection protection", "target": "764-507Restrict XML parsing (against XXE)", "count": 2, "type": "Related"}, {"source": "760-764Injection protection", "target": "048-612Encode user input before logging", "count": 2, "type": "Related"}, {"source": "362-550Personal data handling", "target": "571-640Personal data handling management", "count": 2, "type": "Related"}, {"source": "362-550Personal data handling", "target": "447-083Privacy-preserving personal data logic", "count": 2, "type": "Related"}, {"source": "362-550Personal data handling", "target": "482-866Encrypt personal data at rest", "count": 2, "type": "Related"}, {"source": "058-527Secure name/address resolution service", "target": "336-512Ensure integrity of DNS entries and domains", "count": 2, "type": "Related"}, {"source": "028-728SSRF protection", "target": "814-322Whitelist data sources and sinks", "count": 2, "type": "Related"}, {"source": "028-728SSRF protection", "target": "061-186Force uniform encoders and parsers throughout system", "count": 2, "type": "Related"}, {"source": "028-728SSRF protection", "target": "742-056Ignore/at least validate  filename metadata from untrusted origin (remote file context, eg RFI)", "count": 2, "type": "Related"}, {"source": "028-728SSRF protection", "target": "657-084(SSRF) When depending on internal server input, use validation sanitization and whitelisting", "count": 2, "type": "Related"}, {"source": "760-765XSS protection", "target": "257-668Configure CSP configuration properly", "count": 2, "type": "Related"}, {"source": "760-765XSS protection", "target": "384-344Store and serve user-uploaded files such that they cannot execute/damage server or client", "count": 2, "type": "Related"}, {"source": "760-765XSS protection", "target": "010-308Input validation", "count": 2, "type": "Related"}, {"source": "760-765XSS protection", "target": "161-451Output encoding and injection prevention", "count": 2, "type": "Related"}, {"source": "760-765XSS protection", "target": "764-765Sanitization and sandboxing", "count": 2, "type": "Related"}, {"source": "760-765XSS protection", "target": "804-220Set httponly attribute for cookie-based session tokens", "count": 2, "type": "Related"}, {"source": "616-305Development processes for security", "target": "261-010Program management for secure software development", "count": 2, "type": "Related"}, {"source": "616-305Development processes for security", "target": "148-853Setup and maintain a secure software development process", "count": 2, "type": "Related"}, {"source": "326-704Architecture/design processes", "target": "708-355Secure implemented architecture", "count": 2, "type": "Related"}, {"source": "326-704Architecture/design processes", "target": "626-250Design review", "count": 2, "type": "Related"}, {"source": "124-564Configuration Management", "target": "112-648Change management", "count": 2, "type": "Related"}, {"source": "424-242Decommissioning", "target": "613-285Supply chain management", "count": 2, "type": "Related"}, {"source": "473-177Deploy/build", "target": "223-780Secret storage", "count": 2, "type": "Related"}, {"source": "473-177Deploy/build", "target": "862-452Operating processes for security", "count": 2, "type": "Related"}, {"source": "473-177Deploy/build", "target": "233-748Configuration hardening", "count": 2, "type": "Related"}, {"source": "745-356Development process audit trail", "target": "464-513Assurance processes", "count": 2, "type": "Related"}, {"source": "613-285Supply chain management", "target": "307-507Allow only trusted sources both build time and runtime; therefore perform integrity checks on all resources and code", "count": 2, "type": "Related"}, {"source": "613-285Supply chain management", "target": "433-442Verification", "count": 2, "type": "Related"}, {"source": "613-285Supply chain management", "target": "307-242Security risk assessment", "count": 2, "type": "Related"}, {"source": "244-750Technical application security training", "target": "428-544Security awareness training", "count": 2, "type": "Related"}, {"source": "787-638Technical instructions", "target": "004-517Security requirements", "count": 2, "type": "Related"}, {"source": "433-442Verification", "target": "732-148Vulnerability management", "count": 2, "type": "Related"}, {"source": "433-442Verification", "target": "464-513Assurance processes", "count": 2, "type": "Related"}, {"source": "068-102Describe high-level system architecture and perform threat modeling on it every critical change and regularly", "target": "307-242Security risk assessment", "count": 2, "type": "Related"}, {"source": "072-713Manage standard technologies and frameworks", "target": "004-517Security requirements", "count": 2, "type": "Related"}, {"source": "307-242Security risk assessment", "target": "660-867Implement business logic limits against identified business risks", "count": 2, "type": "Related"}, {"source": "004-517Security requirements", "target": "074-873Data classification and handling", "count": 2, "type": "Related"}, {"source": "004-517Security requirements", "target": "510-324Compliance", "count": 2, "type": "Related"}, {"source": "223-780Secret storage", "target": "287-305Document explicit key/secret management", "count": 2, "type": "Related"}, {"source": "223-780Secret storage", "target": "543-428Use security module to store one-time password verification keys", "count": 2, "type": "Related"}, {"source": "613-286Dependency management", "target": "732-148Vulnerability management", "count": 2, "type": "Related"}, {"source": "613-286Dependency management", "target": "007-274Patching and updating system components", "count": 2, "type": "Related"}, {"source": "732-148Vulnerability management", "target": "463-577Incident response", "count": 2, "type": "Related"}, {"source": "287-823Asset management", "target": "157-587Equipment management", "count": 2, "type": "Related"}, {"source": "287-823Asset management", "target": "522-616Media protection", "count": 2, "type": "Related"}, {"source": "240-464Contingency planning", "target": "163-776Backup", "count": 2, "type": "Related"}, {"source": "074-873Data classification and handling", "target": "724-770Technical application access control", "count": 2, "type": "Related"}, {"source": "724-770Technical application access control", "target": "247-250Access control processes", "count": 2, "type": "Related"}, {"source": "724-770Technical application access control", "target": "132-146Apply defense-in-depth techniques/processes for protection, detection, and timely response to network-based attacks.", "count": 2, "type": "Related"}, {"source": "724-770Technical application access control", "target": "273-600Segregate components of differing trust levels", "count": 2, "type": "Related"}, {"source": "724-770Technical application access control", "target": "278-413Mutually authenticate application components. Minimize privileges", "count": 2, "type": "Related"}, {"source": "724-770Technical application access control", "target": "538-770Data access control", "count": 2, "type": "Related"}, {"source": "724-770Technical application access control", "target": "586-842Secure user management", "count": 2, "type": "Related"}, {"source": "724-770Technical application access control", "target": "551-400Allow user revocation of Oauth tokens", "count": 2, "type": "Related"}, {"source": "782-234Clear policy compliant I/O requirements", "target": "503-455Input and output protection", "count": 2, "type": "Related"}, {"source": "013-021Roles and responsibilities", "target": "247-250Access control processes", "count": 2, "type": "Related"}, {"source": "013-021Roles and responsibilities", "target": "118-775Manage an internal secure software development community", "count": 2, "type": "Related"}, {"source": "417-342Provide reusable application security controls", "target": "344-611Use centralized reusable security controls", "count": 2, "type": "Related"}, {"source": "148-853Setup and maintain a secure software development process", "target": "862-452Operating processes for security", "count": 2, "type": "Related"}, {"source": "850-376Facilities management", "target": "233-748Configuration hardening", "count": 2, "type": "Related"}, {"source": "058-083Monitoring", "target": "842-876Logging and error handling", "count": 2, "type": "Related"}, {"source": "058-083Monitoring", "target": "176-154Monitor expectation of usage intensity (e.g. number of requests)", "count": 2, "type": "Related"}, {"source": "058-083Monitoring", "target": "418-853Monitor unusual activities on system", "count": 2, "type": "Related"}, {"source": "842-876Logging and error handling", "target": "725-682Enable configurable alert against usage anomalies", "count": 2, "type": "Related"}, {"source": "842-876Logging and error handling", "target": "668-364Log TLS connection failures", "count": 2, "type": "Related"}, {"source": "467-784Network security", "target": "278-646Secure communication", "count": 2, "type": "Related"}, {"source": "286-500OS security", "target": "330-281Use least privilege OS accounts for system (components)", "count": 2, "type": "Related"}, {"source": "515-021Sandbox, containerize and/or isolate applications at the network level", "target": "836-068Deserialization Prevention", "count": 2, "type": "Related"}, {"source": "836-068Deserialization Prevention", "target": "184-284Log all security relevant events", "count": 2, "type": "Related"}, {"source": "278-646Secure communication", "target": "270-634Send authentication secrets encrypted", "count": 2, "type": "Related"}, {"source": "278-646Secure communication", "target": "036-147Configure HSTS configuration properly", "count": 2, "type": "Related"}, {"source": "278-646Secure communication", "target": "456-636Add integrity check to SOAP payload", "count": 2, "type": "Related"}, {"source": "586-842Secure user management", "target": "673-736Enable option to log out from all active session", "count": 2, "type": "Related"}, {"source": "177-260Session management", "target": "270-568Authentication mechanism", "count": 2, "type": "Related"}, {"source": "270-568Authentication mechanism", "target": "327-505Change password with presence of old and new password", "count": 2, "type": "Related"}, {"source": "270-568Authentication mechanism", "target": "138-448Inform users for authentication renewal", "count": 2, "type": "Related"}, {"source": "270-568Authentication mechanism", "target": "808-425Notify users about anomalies in their usage patterns", "count": 2, "type": "Related"}, {"source": "270-568Authentication mechanism", "target": "751-176Offer password changing functionality", "count": 2, "type": "Related"}, {"source": "270-568Authentication mechanism", "target": "551-054Use ephemeral secrets rather than static secrets", "count": 2, "type": "Related"}, {"source": "558-807Mutually authenticate application and credential service provider", "target": "228-551TLS", "count": 2, "type": "Related"}, {"source": "113-133Use centralized authentication mechanism", "target": "402-706Log relevant", "count": 2, "type": "Related"}, {"source": "520-617Credential recovery", "target": "235-658Notify user about credential change", "count": 2, "type": "Related"}, {"source": "062-850MFA/OTP", "target": "270-634Send authentication secrets encrypted", "count": 2, "type": "Related"}, {"source": "062-850MFA/OTP", "target": "201-246Use multifactor authentication on administrative interfaces", "count": 2, "type": "Related"}, {"source": "636-347HTTP security headers", "target": "110-531Cookie-config", "count": 2, "type": "Related"}, {"source": "636-347HTTP security headers", "target": "473-758Set sufficient anti-caching headers", "count": 2, "type": "Related"}, {"source": "141-555Fail securely", "target": "036-810Let cryptographic modules fail securely", "count": 2, "type": "Related"}, {"source": "141-555Fail securely", "target": "166-151Ensure that secure fail-safe is in place for access control", "count": 2, "type": "Related"}, {"source": "843-841Log discretely", "target": "015-063Log access to sensitive data", "count": 2, "type": "Related"}];

    const nodesMap = {};
    const addNode = function (name) {
        if (!nodesMap[name]) {
            nodesMap[name] = {id: name, size: 1};
            gData.nodes.push(nodesMap[name])
        } else {
            nodesMap[name].size += 1;
        }
    }
    gData.links.forEach(link => {
        addNode(link.source);
        addNode(link.target);
    });

    const maxNodeSize = gData.nodes.map(n => n.size).reduce((a, b) => Math.max(a, b));
    const maxCount = gData.links.map(l => l.count).reduce((a, b) => Math.max(a, b));

    gData.links = gData.links.map(l => {
        return {source: l.target, target: l.source, count: l.count, type: l.type}
    });

    const Graph = ForceGraph3D()
    (document.getElementById('3d-graph'))
        .graphData(gData)
        .nodeRelSize(4)
        .nodeVal(n => Math.max(20 * n.size / maxNodeSize, 0.001))
        .nodeLabel(n => n.id + " (" + n.size + ")")
        .nodeColor(n => n.id.startsWith("[") ? "skyblue" : "")
        .linkDirectionalParticles(6)
        .linkDirectionalParticleSpeed(d => d.count / maxCount * 0.01)
        .linkOpacity(0.5)
        .linkColor(l => l.type.toLowerCase().includes('relate') ? 'skyblue' : 'white')
        .linkWidth(d => 4);

</script>
</body>
